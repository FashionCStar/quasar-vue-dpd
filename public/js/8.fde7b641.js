(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{"3db5":function(e,t,a){},"4b57":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{attrs:{padding:""}},[[a("div",{staticClass:"q-pa-md"},[a("q-table",{attrs:{data:e.reportList,columns:e.columns,"row-key":"report_date",pagination:e.pagination,filter:e.filter,"binary-state-sort":""},on:{"update:pagination":function(t){e.pagination=t},request:e.getReportList},scopedSlots:e._u([{key:"top",fn:function(){return[a("div",{staticClass:"col-6 row justify-start"},[a("q-input",{staticStyle:{width:"120px"},attrs:{dense:"",debounce:"300",placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}}),e._v("\n            Â \n            "),a("q-btn",{staticClass:"q-mt-xs",staticStyle:{width:"120px",height:"40px"},attrs:{color:"primary",label:"Add Record","no-caps":"",dense:""},on:{click:e.showAddRecordDlg}})],1),a("div",{staticClass:"col-6 row justify-end"},[a("q-input",{staticStyle:{width:"120px"},attrs:{dense:""},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("div",[a("q-calendar",{ref:"calendar",class:e.$q.dark.isActive?"bg-blue-grey-3":"bg-grey-1",staticStyle:{"max-width":"300px","max-height":"180px","min-width":"auto",overflow:"hidden"},attrs:{"show-work-weeks":"",view:"month","mini-mode":"",bordered:"",locale:"en-us"},model:{value:e.fromDate,callback:function(t){e.fromDate=t},expression:"fromDate"}})],1)])],1)]},proxy:!0}]),model:{value:e.fromDate,callback:function(t){e.fromDate=t},expression:"fromDate"}}),a("q-input",{staticClass:"q-ml-xs",staticStyle:{width:"120px"},attrs:{dense:""},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-calendar",{ref:"calendar",class:e.$q.dark.isActive?"bg-blue-grey-3":"bg-grey-1",staticStyle:{"max-width":"300px","max-height":"180px","min-width":"auto",overflow:"hidden"},attrs:{"show-work-weeks":"",view:"month","mini-mode":"",bordered:"",locale:"en-us"},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1)],1)]},proxy:!0}]),model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1)]},proxy:!0},{key:"body",fn:function(t){return[a("q-tr",{attrs:{props:t},nativeOn:{click:function(a){return e.goToDetail(t.row)}}},[a("q-td",{key:"report_date",attrs:{props:t}},[e._v(e._s(t.row.report_date))]),a("q-td",{key:"user_name",attrs:{props:t}},[e._v(e._s(t.row.user.name))]),a("q-td",{key:"option",attrs:{props:t}},[e._v(e._s(1===t.row.is_group?"Group":"Single"))]),a("q-td",{key:"buttons",attrs:{props:t}},[a("q-btn",{attrs:{rounded:"",icon:"fas fa-pen-alt"},on:{click:function(a){return e.goToDetail(t.row)}},nativeOn:{click:function(e){e.stopPropagation()}}}),a("q-btn",{attrs:{rounded:"",icon:"fas fa-trash-alt"},on:{click:function(a){return e.remove(t.row)}},nativeOn:{click:function(e){e.stopPropagation()}}})],1)],1)]}}])})],1),a("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"scale","transition-hide":"scale"},model:{value:e.showAddDlg,callback:function(t){e.showAddDlg=t},expression:"showAddDlg"}},[a("q-card",[a("q-bar",[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}},[a("q-tooltip",{attrs:{"content-class":"bg-white text-primary"}},[e._v("Close")])],1)],1),a("div",{staticClass:"layout-center"},[a("q-card-section",[a("div",{staticClass:"text-h6 text-center"},[e._v("What kind of record do you want to add?")])]),a("q-card-section",{staticClass:"q-pt-none"},[a("q-option-group",{staticClass:"q-mx-auto",staticStyle:{width:"140px"},attrs:{options:e.add_options,type:"radio",size:"xl"},model:{value:e.selectedOption,callback:function(t){e.selectedOption=t},expression:"selectedOption"}})],1),a("q-card-section",{staticClass:"text-center q-pt-none"},[a("q-btn",{staticClass:"q-mt-xs",staticStyle:{width:"100px",height:"40px"},attrs:{color:"primary",label:"Add","no-caps":"",dense:"",rounded:""},on:{click:e.addRecord}})],1)],1)],1)],1),a("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"scale","transition-hide":"scale"},model:{value:e.showDetail,callback:function(t){e.showDetail=t},expression:"showDetail"}},[a("q-card",[a("q-bar",[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}},[a("q-tooltip",{attrs:{"content-class":"bg-white text-primary"}},[e._v("Close")])],1),a("div",{staticClass:"text-h6"},[e._v(e._s(e.dialogTitle))])],1),a("q-separator"),a("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"50vh"}},[a("q-form",{ref:"selectedRecord",staticStyle:{"max-width":"400px",margin:"auto"},attrs:{model:e.selectedRecord},on:{submit:e.onSubmit}},[a("div",{staticClass:"row justify-between q-col-gutter-md"},[a("div",{staticClass:"col-12"},[e.isNewRecord?a("q-input",{attrs:{dense:"",outlined:""},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-calendar",{ref:"calendar",class:e.$q.dark.isActive?"bg-blue-grey-3":"bg-grey-1",staticStyle:{"max-width":"300px","max-height":"180px","min-width":"auto",overflow:"hidden"},attrs:{"show-work-weeks":"",view:"month","mini-mode":"",bordered:"",locale:"en-us"},model:{value:e.fromDate,callback:function(t){e.fromDate=t},expression:"fromDate"}})],1)],1)]},proxy:!0}],null,!1,3137925472),model:{value:e.selectedRecord.report_date,callback:function(t){e.$set(e.selectedRecord,"report_date",t)},expression:"selectedRecord.report_date"}}):e._e(),a("q-separator",{staticClass:"q-my-md"}),a("q-select",{staticClass:"q-mb-xs",attrs:{dense:"",label:"Courier",outlined:"","use-input":"","hide-selected":"","fill-input":"",options:e.filteredNames,"option-value":function(e){return null===e?null:e.id},"option-label":function(e){return null===e?"- Null -":e.courier_name},"emit-value":"","map-options":"",color:"cyan-7",behavior:"menu"},on:{filter:e.filterFn},model:{value:e.selectedRecord.courier_id,callback:function(t){e.$set(e.selectedRecord,"courier_id",t)},expression:"selectedRecord.courier_id"}}),a("q-select",{staticClass:"q-mb-xs",attrs:{dense:"",required:"",label:"Route",outlined:"","use-input":"","hide-selected":"","fill-input":"",options:e.routes,"option-value":function(e){return null===e?null:e.id},"option-label":function(e){return null===e?"- Null -":e.route_number},"emit-value":"","map-options":"",color:"cyan-7",behavior:"menu"},model:{value:e.selectedRecord.route_id,callback:function(t){e.$set(e.selectedRecord,"route_id",t)},expression:"selectedRecord.route_id"}})],1)]),a("q-card-actions",{attrs:{align:"center"}},[a("q-btn",{staticClass:"q-mt-xs",staticStyle:{width:"100px",height:"40px"},attrs:{color:"primary",label:"Add","no-caps":"",dense:"",rounded:"",type:"submit"}})],1)],1)],1)],1)],1)]],2)},r=[],s=a("967e"),i=a.n(s),n=(a("96cf"),a("1e53")),c=a("f508"),d=a("bd4c"),l={name:"ReportList",data:function(){return{filter:"",showDetail:!1,showAddDlg:!1,add_options:[{label:"FD routes",value:"fd_routes"},{label:"Extra route",value:"extra_route"}],selectedOption:"",pagination:{sortBy:"report_date",descending:!0,page:1,rowsPerPage:10,rowsNumber:20},fromDate:"",endDate:"",columns:[{name:"report_date",required:!0,label:"Date",align:"left",field:"report_date",sortable:!0},{name:"user_name",required:!0,label:"Manager",align:"center",field:"user_name",sortable:!0},{name:"option",required:!0,label:"Option",align:"center",field:"option"},{name:"buttons",label:"",field:"buttons"}],reportList:[],selectedRecord:{id:"",report_date:"",report_title:"",courier_id:"",route_id:""},isNewRecord:!1,dialogTitle:"",routes:[],couriers:[],filteredNames:[]}},watch:{fromDate:{handler:function(e,t){},deep:!0},endDate:{handler:function(e,t){},deep:!0}},mounted:function(){this.$store.commit("auth/pageTitle",this.$router.currentRoute.meta.title),this.fromDate=d["a"].formatDate(new Date,"YYYY-MM-DD"),this.endDate=d["a"].formatDate(new Date,"YYYY-MM-DD"),this.getReportList({pagination:this.pagination,filter:void 0})},methods:{createNew:function(){this.$router.push({path:"reports/new"})},showAddRecordDlg:function(){this.showAddDlg=!0},hideAddRecordDlg:function(){this.showAddDlg=!1,this.selectedOption=""},addRecord:function(){console.log("ddddddddd",this.selectedOption),"extra_route"===this.selectedOption?this.goToDetail():"fd_routes"===this.selectedOption&&this.$router.push({path:"reports/new"})},goToDetail:function(e){return i.a.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.a.awrap(this.getCourierList());case 2:return t.next=4,i.a.awrap(this.getRouteList());case 4:e?1===e.is_group?this.$router.push({name:"ReportDetail",params:{report_no:e.report_no}}):(this.isNewRecord=!1,this.filteredNames=this.couriers,this.dialogTitle="Edit Record",this.selectedRecord.id=e.id,this.selectedRecord.courier_id=e.courier_id,this.selectedRecord.route_id=e.route_id,this.selectedRecord.report_date=e.report_date,console.log("dddddddddddddd",this.selectedRecord)):(this.dialogTitle="Add New Record",this.isNewRecord=!0,this.selectedRecord.report_date=d["a"].formatDate(new Date,"YYYY-MM-DD"),this.selectedRecord.courier_id="",this.selectedRecord.route_id=""),console.log("xxxxxxxxxxxxxxx",this.selectedRecord),this.showDetail=!0;case 7:case"end":return t.stop()}}),null,this)},cancelDetail:function(){this.showDetail=!1,this.selectedRecord={}},onSubmit:function(){var e,t,a;return i.a.async((function(o){while(1)switch(o.prev=o.next){case 0:if(this.selectedRecord.report_date=d["a"].formatDate(d["a"].addToDate(this.selectedRecord.report_date,{days:1}),"YYYY-MM-DD"),this.selectedRecord.courier_id||(this.selectedRecord.courier_id="RNC"),e={data:this.selectedRecord},this.isNewRecord){o.next=21;break}return e.conditions={id:this.selectedRecord.id},c["a"].show(),o.prev=6,o.next=9,i.a.awrap(n["a"].updateSingleRecord(e));case 9:t=o.sent,c["a"].hide(),console.log("result",t.data),o.next=18;break;case 14:o.prev=14,o.t0=o["catch"](6),c["a"].hide(),console.log("error",o.t0);case 18:this.$router.push("/dashboard/reports"),o.next=34;break;case 21:return c["a"].show(),o.prev=22,o.next=25,i.a.awrap(n["a"].createSingleRecord(e));case 25:a=o.sent,c["a"].hide(),console.log("result",a.data),o.next=34;break;case 30:o.prev=30,o.t1=o["catch"](22),c["a"].hide(),console.log("error",o.t1);case 34:this.cancelDetail(),this.hideAddRecordDlg(),this.getReportList({pagination:this.pagination,filter:this.filter}),console.log("selected record",this.selectedRecord);case 38:case"end":return o.stop()}}),null,this,[[6,14],[22,30]])},getRouteList:function(){var e;return i.a.async((function(t){while(1)switch(t.prev=t.next){case 0:return c["a"].show(),t.prev=1,t.next=4,i.a.awrap(n["a"].getRouteList());case 4:e=t.sent,c["a"].hide(),this.routes=e.data.data,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),c["a"].hide();case 12:case"end":return t.stop()}}),null,this,[[1,9]])},getCourierList:function(){var e;return i.a.async((function(t){while(1)switch(t.prev=t.next){case 0:return c["a"].show(),t.prev=1,t.next=4,i.a.awrap(n["a"].getCourierList());case 4:e=t.sent,c["a"].hide(),this.couriers=e.data.data,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),c["a"].hide();case 12:case"end":return t.stop()}}),null,this,[[1,9]])},filterFn:function(e,t,a){var o=this;t((function(){if(""===e)o.filteredNames=[];else{var t=e.toLowerCase();o.filteredNames=o.couriers.filter((function(e){return e.courier_name.toLowerCase().indexOf(t)>-1})),o.filteredNames=o.filteredNames.slice(0,3)}}))},getReportList:function(e){var t,a,o,r,s,d,l,u,p,h,f;return i.a.async((function(m){while(1)switch(m.prev=m.next){case 0:return t=e.pagination,a=t.page,o=t.rowsPerPage,r=t.rowsNumber,s=t.sortBy,d=t.descending,l=e.filter,u=0===o?r:o,p=(a-1)*o,h={conditions:{},start:p,numPerPage:u,sortBy:s,descending:d},l&&(h.conditions.filter=l),c["a"].show(),m.prev=7,m.next=10,i.a.awrap(n["a"].getReports(h));case 10:f=m.sent,c["a"].hide(),this.reportList=f.data.data,this.reportList.forEach((function(e,t){e.index=t+1})),this.pagination.rowsNumber=f.data.totalCount,this.pagination.page=a,this.pagination.rowsPerPage=o,this.pagination.sortBy=s,this.pagination.descending=d,m.next=24;break;case 21:m.prev=21,m.t0=m["catch"](7),c["a"].hide();case 24:case"end":return m.stop()}}),null,this,[[7,21]])},remove:function(e){var t=this;this.$q.dialog({title:"Confirm",message:"Are you surely remove "+e.report_title+"?",cancel:!0,persistent:!0}).onOk((function(){var a,o;return i.a.async((function(r){while(1)switch(r.prev=r.next){case 0:return a={conditions:{report_no:e.report_no}},c["a"].show(),r.prev=2,r.next=5,i.a.awrap(n["a"].removeReport(a));case 5:o=r.sent,c["a"].hide(),console.log("remove result",o),t.$q.notify({color:"positive",position:"top",message:e.report_title+" is removed successfully !"}),t.getReportList({pagination:t.pagination,filter:void 0}),r.next=15;break;case 12:r.prev=12,r.t0=r["catch"](2),c["a"].hide();case 15:case"end":return r.stop()}}),null,null,[[2,12]])})).onCancel((function(){})).onDismiss((function(){}))}},created:function(){}},u=l,p=(a("ee35"),a("2877")),h=a("9989"),f=a("eaac"),m=a("27f9"),w=a("0016"),g=a("9c40"),x=a("7cbe"),v=a("bd08"),b=a("db86"),y=a("24e8"),q=a("f09f"),_=a("d847"),D=a("05c0"),R=a("a370"),k=a("9f0a"),C=a("eb85"),S=a("0378"),N=a("ddd8"),A=a("4b7e"),L=a("7f67"),Q=a("eebe"),P=a.n(Q),O=Object(p["a"])(u,o,r,!1,null,null,null);t["default"]=O.exports;P()(O,"components",{QPage:h["a"],QTable:f["a"],QInput:m["a"],QIcon:w["a"],QBtn:g["a"],QPopupProxy:x["a"],QTr:v["a"],QTd:b["a"],QDialog:y["a"],QCard:q["a"],QBar:_["a"],QTooltip:D["a"],QCardSection:R["a"],QOptionGroup:k["a"],QSeparator:C["a"],QForm:S["a"],QSelect:N["a"],QCardActions:A["a"]}),P()(O,"directives",{ClosePopup:L["a"]})},ee35:function(e,t,a){"use strict";var o=a("3db5"),r=a.n(o);r.a}}]);