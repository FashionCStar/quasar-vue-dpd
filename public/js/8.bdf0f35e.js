(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{"1c1e":function(t,e,r){},ca5e:function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-page",{staticClass:"q-mt-none",staticStyle:{"background-color":"#3E444E"}},[[r("div",[r("q-bar",{staticStyle:{"background-color":"#3E444E"}},[r("q-btn",{attrs:{dense:"",flat:"",icon:"close",color:"white"},on:{click:function(e){return t.$router.push("/dashboard/schedules")}}}),r("div",{staticClass:"text-h6 text-white"},[t._v("Edit Daily Report")])],1)],1),r("div",{staticClass:"q-px-md",staticStyle:{"background-color":"#3E444E"}},[r("q-form",{ref:"reportForm",staticClass:"text-center q-px-md",staticStyle:{"max-width":"400px",width:"100%",margin:"auto"},attrs:{rounded:"",model:t.reportForm},on:{submit:t.onSubmit}},[r("q-card",{staticStyle:{"background-color":"#3E444E","box-shadow":"none"}},[r("q-card-section",{staticClass:"text-left q-pb-none"},[r("span",{staticClass:"text-white"},[t._v("Date")]),r("q-input",{staticClass:"q-pb-md",attrs:{dense:"",outlined:"","bg-color":"white",color:"blue-7","input-class":"text-black text-center"},scopedSlots:t._u([{key:"append",fn:function(){return[r("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event",color:"black"}},[r("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[r("q-date",{attrs:{minimal:"",mask:"DD/MM/YY ddd",color:"blue-7"},on:{input:t.onReportDateChanged},model:{value:t.reportDate,callback:function(e){t.reportDate=e},expression:"reportDate"}})],1)],1)]},proxy:!0}]),model:{value:t.reportDate,callback:function(e){t.reportDate=e},expression:"reportDate"}}),r("q-separator",{attrs:{color:"grey-4"}})],1),t._l(t.reportForm.report_data,(function(e,o){return r("div",{key:e.route_id},[r("q-card-section",{staticClass:"text-left q-pb-none"},[r("span",{staticClass:"text-white"},[t._v("Courier")]),r("q-select",{staticClass:"q-ma-none q-pb-none",attrs:{dense:"",outlined:"","use-input":"","hide-selected":"","fill-input":"",options:t.filteredNames,"option-value":function(t){return null===t?null:t.id},"option-label":function(t){return null===t?"- Null -":t.courier_name},"emit-value":"","map-options":"","label-color":"grey-7",behavior:"menu","bg-color":"white","input-class":"text-black text-center",rules:[function(e){return t.checkDuplicates(e)||"This record is duplicated"}],"hide-dropdown-icon":!0,color:"blue-7"},on:{filter:t.filterFn},scopedSlots:t._u([{key:"append",fn:function(){return[""!==e.courier_id?r("q-icon",{staticClass:"cursor-pointer",attrs:{name:"clear"},on:{click:function(e){return t.removeCourier(o)}}}):t._e()]},proxy:!0}],null,!0),model:{value:e.courier_id,callback:function(r){t.$set(e,"courier_id",r)},expression:"data.courier_id"}}),r("span",{staticClass:"text-white"},[t._v("Route")]),r("q-input",{staticClass:"q-pb-md",attrs:{required:"",dense:"",outlined:"","bg-color":"blue-grey-4","input-class":"text-white text-center q-pr-xl","label-color":"grey-3",color:"blue-7",value:e.route_number,disable:""}}),o<t.reportForm.report_data.length-1?r("q-separator",{attrs:{color:"grey-4"}}):t._e()],1)],1)})),r("q-card-actions",{attrs:{align:"center"}},[r("div",{staticClass:"q-px-md"},[r("q-btn",{staticStyle:{width:"100px",height:"40px"},attrs:{"no-caps":"",dense:"",rounded:"",label:"Delete",color:"blue-7"},on:{click:function(e){return t.remove(t.reportForm)}}}),t._v(" Â \n              "),r("q-btn",{staticStyle:{width:"100px",height:"40px"},attrs:{color:"blue-7",label:"Update","no-caps":"",dense:"",rounded:"",type:"submit"}})],1)])],2)],1)],1),r("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"scale","transition-hide":"scale"},model:{value:t.showEmptyDlg,callback:function(e){t.showEmptyDlg=e},expression:"showEmptyDlg"}},[r("q-card",{staticStyle:{"background-color":"#3E444E"}},[r("q-bar",[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close",color:"white"}},[r("q-tooltip",{attrs:{"content-class":"bg-white text-primary"}},[t._v("Close")])],1)],1),r("div",{staticClass:"layout-center"},[r("q-card-section",{staticClass:"text-white"},[r("div",{staticClass:"text-h6 text-center"},[t._v("You did not provide the driver name of the routes "+t._s(t.checkEmptyDrivers().join(","))+".")]),r("div",{staticClass:"text-h6 text-center"},[t._v("Do you want to continue?")])]),r("q-card-section",{staticClass:"text-center q-pt-none"},[r("q-btn",{staticClass:"q-mt-xs q-mx-xs",staticStyle:{width:"100px",height:"40px"},attrs:{color:"blue-7",label:"Back","no-caps":"",dense:"",rounded:""},on:{click:function(e){t.showEmptyDlg=!1}}}),r("q-btn",{staticClass:"q-mt-xs q-mx-xs",staticStyle:{width:"100px",height:"40px"},attrs:{color:"blue-7",label:"Yes","no-caps":"",dense:"",rounded:""},on:{click:t.addRecords}})],1)],1)],1)],1)]],2)},a=[],n=(r("7514"),r("a34a")),s=r.n(n),i=(r("96cf"),r("c973")),c=r.n(i),u=r("1e53"),d=r("f508"),l=r("bd4c"),p={name:"EditSchedule",data:function(){return{showEmptyDlg:!1,reportDate:"",reportForm:{report_date:"",report_title:"",report_no:"",user_id:"",report_data:[]},routes:[],couriers:[],filteredNames:[],rnc_id:"",reportCreatedAt:""}},created:function(){var t=this;return c()(s.a.mark((function e(){return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isNew(),t.reportForm.user_id=t.$store.getters["auth/user"].id,t.reportDate=l["b"].formatDate(new Date,"DD/MM/YY ddd"),t.reportForm.report_date=l["b"].formatDate(new Date,"YYYY-MM-DD"),e.next=6,t.getRNCID();case 6:return e.next=8,t.getReportInfo(t.reportForm.report_no);case 8:return e.next=10,t.getCourierList(t.reportCreatedAt);case 10:case"end":return e.stop()}}),e)})))()},methods:{isNew:function(){null!==this.$router.currentRoute.params.report_no&&void 0!==this.$router.currentRoute.params.report_no&&""!==this.$router.currentRoute.params.report_no&&(this.reportForm.report_no=this.$router.currentRoute.params.report_no)},onReportDateChanged:function(t){this.reportForm.report_date=l["b"].formatDate(l["b"].extractDate(t,"DD/MM/YY ddd"),"YYYY-MM-DD")},getReportInfo:function(){var t=c()(s.a.mark((function t(e){var r;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return d["a"].show(),t.prev=1,t.next=4,u["a"].getReportInfo(e);case 4:r=t.sent,d["a"].hide(),this.reportDate=l["b"].formatDate(l["b"].extractDate(r.data.data[0].report_date,"YYYY-MM-DD"),"DD/MM/YY ddd"),this.reportForm.report_date=r.data.data[0].report_date,this.reportForm.report_title=r.data.data[0].report_title,this.reportForm.report_no=r.data.data[0].report_no,this.reportForm.report_data=r.data.data.map((function(t){var e={id:t.id,courier_id:t.courier_id,route_id:t.route_id,route_number:t.route.route_number};return e})),this.reportCreatedAt=r.data.data[0].created_at,t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](1),d["a"].hide(),this.$router.push("/dashboard/schedules");case 18:case"end":return t.stop()}}),t,this,[[1,14]])})));function e(e){return t.apply(this,arguments)}return e}(),getCourierList:function(){var t=c()(s.a.mark((function t(e){var r;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return d["a"].show(),t.prev=1,t.next=4,u["a"].getCourierList(e);case 4:r=t.sent,d["a"].hide(),this.couriers=r.data.data,this.filteredNames=this.couriers,t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](1),d["a"].hide(),this.$router.push("/dashboard/schedules");case 14:case"end":return t.stop()}}),t,this,[[1,10]])})));function e(e){return t.apply(this,arguments)}return e}(),removeCourier:function(t){this.reportForm.report_data[t].courier_id="",this.reportForm.report_data[t].courier_name=""},filterFn:function(t,e,r){var o=this;e((function(){if(""===t)o.filteredNames=[];else{var e=t.toLowerCase();o.filteredNames=o.couriers.filter((function(t){return t.courier_name.toLowerCase().indexOf(e)>-1})),o.filteredNames=o.filteredNames.slice(0,3)}}),(function(e){if(""!==t&&e.options.length>0){console.log("valll",t);var r=e.options.find((function(e){return e.courier_name.toLowerCase()===t.toLowerCase()}));r&&e.add(r)}}))},getRNCID:function(){var t=c()(s.a.mark((function t(){var e;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return d["a"].show(),t.prev=1,t.next=4,u["a"].getRNCID();case 4:e=t.sent,d["a"].hide(),this.rnc_id=e.data.data,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),d["a"].hide();case 12:case"end":return t.stop()}}),t,this,[[1,9]])})));function e(){return t.apply(this,arguments)}return e}(),checkDuplicates:function(t){var e=this;if(t){var r=this.reportForm.report_data.map((function(t){return t.courier_id}));r=r.filter((function(t,r){return""!==t&&"RNC"!==t&&t!==e.rnc_id}));var o=r.filter((function(e,o){return e===t&&r.indexOf(e)!==o}));return!(o.length>0)}return!0},checkEmptyDrivers:function(){var t=this.reportForm.report_data.filter((function(t,e){return""===t.courier_id})),e=t.map((function(t){return t.route_number}));return e},addRecords:function(){var t=this;return c()(s.a.mark((function e(){var r,o;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.reportForm.report_data=t.reportForm.report_data.map((function(e){var r={};return e.courier_id?r=e:(e.id&&(r.id=e.id),r.courier_id=t.rnc_id,r.route_id=e.route_id),r})),r={data:t.reportForm},r.conditions={report_no:t.reportForm.report_no},d["a"].show(),e.prev=4,e.next=7,u["a"].updateReport(r);case 7:o=e.sent,d["a"].hide(),console.log("result",o.data),t.$router.push("/dashboard/schedules"),e.next=18;break;case 13:e.prev=13,e.t0=e["catch"](4),d["a"].hide(),console.log("error",e.t0),t.$router.push("/dashboard/schedules");case 18:case"end":return e.stop()}}),e,null,[[4,13]])})))()},onSubmit:function(){this.checkEmptyDrivers().length?this.showEmptyDlg=!0:this.addRecords()},remove:function(t){var e=this;this.$q.dialog({title:"Confirm",message:"Are you surely remove this report?",cancel:!0,persistent:!0,color:"blue-7"}).onOk(c()(s.a.mark((function r(){var o,a;return s.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o={conditions:{report_no:t.report_no}},d["a"].show(),r.prev=2,r.next=5,u["a"].removeReport(o);case 5:a=r.sent,d["a"].hide(),console.log("remove result",a),e.$q.notify({color:"positive",position:"top",message:"Report is removed successfully !"}),e.$router.push("/dashboard/schedules"),r.next=15;break;case 12:r.prev=12,r.t0=r["catch"](2),d["a"].hide();case 15:case"end":return r.stop()}}),r,null,[[2,12]])})))).onCancel((function(){})).onDismiss((function(){}))}}},h=p,m=(r("dce5"),r("2877")),f=r("9989"),v=r("d847"),b=r("9c40"),_=r("0378"),x=r("f09f"),w=r("a370"),D=r("27f9"),g=r("0016"),q=r("7cbe"),C=r("52ee"),y=r("eb85"),k=r("ddd8"),F=r("4b7e"),E=r("24e8"),Y=r("05c0"),R=r("7f67"),S=r("eebe"),N=r.n(S),Q=Object(m["a"])(h,o,a,!1,null,null,null);e["default"]=Q.exports;N()(Q,"components",{QPage:f["a"],QBar:v["a"],QBtn:b["a"],QForm:_["a"],QCard:x["a"],QCardSection:w["a"],QInput:D["a"],QIcon:g["a"],QPopupProxy:q["a"],QDate:C["a"],QSeparator:y["a"],QSelect:k["a"],QCardActions:F["a"],QDialog:E["a"],QTooltip:Y["a"]}),N()(Q,"directives",{ClosePopup:R["a"]})},dce5:function(t,e,r){"use strict";var o=r("1c1e"),a=r.n(o);a.a}}]);