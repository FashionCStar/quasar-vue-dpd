(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"1e37":function(e,t,a){},"4fc9":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[[a("div",[a("q-table",{class:e.is_mobile?"my-sticky-dynamic table-top-mobile":"my-sticky-dynamic",attrs:{data:e.monthlyList,columns:"admin"===e.userLevel?e.columns_admin:e.columns,"row-key":"report_date",filter:e.filter,"binary-state-sort":"",pagination:e.pagination},on:{request:e.getMonthlyList,"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"top",fn:function(){return[a("div",{staticClass:"col-6 row justify-start"},[a("q-input",{staticClass:"q-mb-sm",staticStyle:{width:"168px"},attrs:{dense:"",debounce:"300",placeholder:"Search","input-class":"text-white",color:"blue-7"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search",color:"white"}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1),a("div",{staticClass:"col-6 row justify-end"},[a("q-input",{staticClass:"q-mb-sm",staticStyle:{width:"168px"},attrs:{dense:"","input-class":"text-white",color:"blue-7"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event",color:"white"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{minimal:"",mask:"DD/MM/YY ddd",color:"blue-7"},on:{input:e.onFromDateChanged},model:{value:e.fromDate,callback:function(t){e.fromDate=t},expression:"fromDate"}})],1)],1)]},proxy:!0}]),model:{value:e.fromDate,callback:function(t){e.fromDate=t},expression:"fromDate"}}),a("q-input",{staticClass:"q-ml-xs q-mb-sm",staticStyle:{width:"168px"},attrs:{dense:"","input-class":"text-white",color:"blue-7"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event",color:"white"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{minimal:"",mask:"DD/MM/YY ddd",color:"blue-7"},on:{input:e.onEndDateChanged},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1)],1)]},proxy:!0}]),model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1)]},proxy:!0},{key:"body",fn:function(t){return[a("q-tr",{attrs:{props:t},on:{click:function(a){return e.goToSingleDetail(t.row)}}},[a("q-td",{key:"index",attrs:{props:t}},[e._v(e._s(t.row.index))]),a("q-td",{key:"created_at",staticClass:"text-uppercase",attrs:{props:t}},[e._v(e._s(e.changeDateFormat(t.row.created_at)))]),a("q-td",{key:"route_number",attrs:{props:t}},[e._v(e._s(t.row.route_number))]),a("q-td",{key:"courier_name",attrs:{props:t}},[e._v(e._s(t.row.courier_name))]),a("q-td",{key:"is_group",attrs:{props:t}},[e._v(e._s(1===t.row.is_group?"DAILY":"EXTRA"))]),"admin"===e.userLevel?a("q-td",{key:"user_name",attrs:{props:t}},[e._v(e._s(t.row.user.name))]):e._e()],1)]}},{key:"bottom",fn:function(t){return[a("div",{staticClass:"col-12 row justify-between"},[a("div",{staticClass:"q-my-auto"},[a("q-btn",{staticClass:"q-ma-none",staticStyle:{width:"60px",height:"30px"},attrs:{label:"Export","no-caps":"",dense:"",rounded:"",outline:""},on:{click:e.exportTable}})],1),a("div",{staticClass:"col-6 row justify-end items-center"},[e._v("\n              Total Records: "+e._s(e.pagination.rowsNumber)+"\n              "),a("q-btn",{attrs:{icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:t.isFirstPage},on:{click:t.prevPage}}),a("span",[e._v(e._s(t.pagination.page)+" / "+e._s(Math.ceil(t.pagination.rowsNumber/t.pagination.rowsPerPage)))]),a("q-btn",{attrs:{icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:t.isLastPage},on:{click:t.nextPage}})],1)])]}}])})],1),a("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"scale","transition-hide":"scale"},model:{value:e.showDetail,callback:function(t){e.showDetail=t},expression:"showDetail"}},[a("q-card",{staticStyle:{"background-color":"#3E444E"}},[a("q-bar",[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close",color:"white"}},[a("q-tooltip",{attrs:{"content-class":"bg-white text-primary"}},[e._v("Close")])],1),a("div",{staticClass:"text-h6 text-white"},[e._v(e._s(e.dialogTitle))])],1),a("q-separator"),a("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"50vh"}},[a("q-form",{ref:"selectedRecord",staticStyle:{"max-width":"400px",margin:"auto"},attrs:{model:e.selectedRecord},on:{submit:e.onSubmit}},[a("q-card",{staticStyle:{"background-color":"#3E444E"}},[a("q-card-section",[a("q-input",{attrs:{dense:"",outlined:"","bg-color":"white","input-class":"text-black text-center",color:"blue-7"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-calendar",{ref:"calendar",class:e.$q.dark.isActive?"bg-blue-grey-3":"bg-grey-1",staticStyle:{"max-width":"300px","max-height":"180px","min-width":"auto",overflow:"hidden"},attrs:{"show-work-weeks":"",view:"month","mini-mode":"","enable-outside-days":"",bordered:"",locale:"en-us"},model:{value:e.selectedRecord.report_date,callback:function(t){e.$set(e.selectedRecord,"report_date",t)},expression:"selectedRecord.report_date"}})],1)],1)]},proxy:!0}]),model:{value:e.selectedRecord.report_date,callback:function(t){e.$set(e.selectedRecord,"report_date",t)},expression:"selectedRecord.report_date"}})],1),a("q-separator",{attrs:{color:"grey-4"}}),a("q-card-section",[a("q-select",{staticClass:"q-mb-xs",attrs:{dense:"",label:"Courier",outlined:"","use-input":"","hide-selected":"","fill-input":"",options:e.filteredNames,"option-value":function(e){return null===e?null:e.id},"option-label":function(e){return null===e?"- Null -":e.courier_name},"emit-value":"","map-options":"",behavior:"menu","bg-color":"white","input-class":"text-black",color:"blue-7"},on:{filter:e.filterFn},model:{value:e.selectedRecord.courier_id,callback:function(t){e.$set(e.selectedRecord,"courier_id",t)},expression:"selectedRecord.courier_id"}}),a("q-select",{staticClass:"q-mb-xs",attrs:{dense:"",required:"",label:"Route",outlined:"","use-input":"","hide-selected":"","fill-input":"",options:e.routes,"option-value":function(e){return null===e?null:e.id},"option-label":function(e){return null===e?"- Null -":e.route_number},"emit-value":"","map-options":"",behavior:"menu","bg-color":"white","input-class":"text-black",color:"blue-7"},model:{value:e.selectedRecord.route_id,callback:function(t){e.$set(e.selectedRecord,"route_id",t)},expression:"selectedRecord.route_id"}})],1),a("q-card-actions",{attrs:{align:"center"}},[a("q-btn",{staticClass:"q-mt-xs",staticStyle:{width:"100px",height:"40px"},attrs:{color:"blue-7",label:e.isNewRecord?"Add":"Update","no-caps":"",dense:"",rounded:"",type:"submit"}})],1)],1)],1)],1)],1)],1)]],2)},i=[],o=(a("7514"),a("967e")),n=a.n(o),s=(a("96cf"),a("28a5"),a("1e53")),l=a("f508"),c=a("bd4c"),d=a("a357");function u(e,t){var a=void 0!==t?t(e):e;return a=void 0===a||null===a?"":String(a),a=a.split('"').join('""'),'"'.concat(a,'"')}var p={name:"MonthlyReportList",components:{},data:function(){return{filter:"",fromDate:"",fromDateAPI:"",endDate:"",endDateAPI:"",showDetail:!1,pagination:{sortBy:"created_at",descending:!0,page:1,rowsPerPage:10,rowsNumber:20},columns:[{name:"index",required:!0,label:"NO",align:"left",field:"index"},{name:"created_at",required:!0,label:"DATE",align:"left",field:"created_at"},{name:"route_number",required:!0,label:"ROUTE",align:"left",field:"route_number"},{name:"courier_name",required:!0,label:"DRIVER",align:"left",field:"courier_name"},{name:"is_group",required:!0,label:"TYPE",align:"left",field:"is_group"}],columns_admin:[{name:"index",required:!0,label:"NO",align:"left",field:"index"},{name:"created_at",required:!0,label:"DATE",align:"left",field:"created_at"},{name:"route_number",required:!0,label:"ROUTE",align:"left",field:"route_number"},{name:"courier_name",required:!0,label:"DRIVER",align:"left",field:"courier_name"},{name:"is_group",required:!0,label:"TYPE",align:"left",field:"is_group"},{name:"user_name",required:!0,label:"USER",align:"left",field:"user_name"}],monthlyList:[],selectedRecord:{id:"",report_date:"",report_title:"",courier_id:"",route_id:""},isNewRecord:!1,dialogTitle:"",routes:[],couriers:[],filteredNames:[],rnc_id:"",is_mobile:!1}},computed:{userLevel:{get:function(){return this.$store.state.auth.userLevel}}},mounted:function(){this.checkPlatform(),this.$store.commit("auth/pageTitle",this.$router.currentRoute.meta.title),this.fromDate=c["b"].formatDate(c["b"].startOfDate(new Date,"month"),"DD/MM/YY ddd"),this.fromDateAPI=c["b"].formatDate(c["b"].startOfDate(new Date,"month"),"YYYY-MM-DD"),this.endDate=c["b"].formatDate(new Date,"DD/MM/YY ddd"),this.endDateAPI=c["b"].formatDate(new Date,"YYYY-MM-DD"),this.getMonthlyList({pagination:this.pagination,filter:void 0})},methods:{checkPlatform:function(){this.$q.platform.is.mobile?this.is_mobile=!0:this.is_mobile=!1},changeDateFormat:function(e){var t=c["b"].formatDate(c["b"].addToDate(c["b"].extractDate(e,"YYYY-MM-DD HH:mm:ss"),{hours:5}),"DD-MM-YY dddd");return t},onFromDateChanged:function(e){this.fromDateAPI=c["b"].formatDate(c["b"].extractDate(e,"DD/MM/YY ddd"),"YYYY-MM-DD"),this.getMonthlyList({pagination:this.pagination,filter:void 0})},onEndDateChanged:function(e){this.endDateAPI=c["b"].formatDate(c["b"].extractDate(e,"DD/MM/YY ddd"),"YYYY-MM-DD"),this.getMonthlyList({pagination:this.pagination,filter:void 0})},goToSingleDetail:function(e){return n.a.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.a.awrap(this.getCourierList());case 2:return t.next=4,n.a.awrap(this.getExtraRoutes());case 4:1===e.is_group?this.$router.push({name:"Edit Schedule",params:{report_no:e.report_no}}):(this.isNewRecord=!1,this.filteredNames=this.couriers,this.dialogTitle="Edit Extra Route",this.selectedRecord.id=e.id,this.selectedRecord.courier_id=e.courier_id,this.selectedRecord.route_id=e.route_id,this.selectedRecord.report_date=e.report_date),this.showDetail=!0;case 6:case"end":return t.stop()}}),null,this)},addGroup:function(){this.$router.push("/dashboard/schedules/new")},cancelDetail:function(){this.showDetail=!1,this.selectedRecord={}},onSubmit:function(){var e,t;return n.a.async((function(a){while(1)switch(a.prev=a.next){case 0:return this.selectedRecord.courier_id||(this.selectedRecord.courier_id="RNC"),e={data:this.selectedRecord},e.conditions={id:this.selectedRecord.id},l["a"].show(),a.prev=4,a.next=7,n.a.awrap(s["a"].updateSingleRecord(e));case 7:t=a.sent,l["a"].hide(),console.log("result",t.data),a.next=16;break;case 12:a.prev=12,a.t0=a["catch"](4),l["a"].hide(),console.log("error",a.t0);case 16:this.cancelDetail(),this.getMonthlyList({pagination:this.pagination,filter:this.filter}),console.log("selected record",this.selectedRecord);case 19:case"end":return a.stop()}}),null,this,[[4,12]])},getExtraRoutes:function(){var e;return n.a.async((function(t){while(1)switch(t.prev=t.next){case 0:return l["a"].show(),t.prev=1,t.next=4,n.a.awrap(s["a"].getExtraRoutes());case 4:e=t.sent,l["a"].hide(),this.routes=e.data.data,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),l["a"].hide();case 12:case"end":return t.stop()}}),null,this,[[1,9]])},getCourierList:function(){var e;return n.a.async((function(t){while(1)switch(t.prev=t.next){case 0:return l["a"].show(),t.prev=1,t.next=4,n.a.awrap(s["a"].getCourierList());case 4:e=t.sent,l["a"].hide(),this.couriers=e.data.data,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),l["a"].hide();case 12:case"end":return t.stop()}}),null,this,[[1,9]])},filterFn:function(e,t,a){var r=this;t((function(){if(""===e)r.filteredNames=[];else{var t=e.toLowerCase();r.filteredNames=r.couriers.filter((function(e){return e.courier_name.toLowerCase().indexOf(t)>-1})),r.filteredNames=r.filteredNames.slice(0,3)}}),(function(t){if(""!==e&&t.options.length>0){var a=t.options.find((function(t){return t.courier_name.toLowerCase()===e.toLowerCase()}));a&&t.add(a)}}))},getMonthlyList:function(e){var t,a,r,i,o,c,d,u,p,h,m;return n.a.async((function(f){while(1)switch(f.prev=f.next){case 0:return t=e.pagination,a=t.page,r=t.rowsPerPage,i=t.rowsNumber,o=t.sortBy,c=t.descending,d=e.filter,u=0===r?i:r,p=(a-1)*r,h={conditions:{},start:p,numPerPage:u,sortBy:o,descending:c,fromDate:this.fromDateAPI,endDate:this.endDateAPI},d&&(h.conditions.filter=d),l["a"].show(),f.prev=7,f.next=10,n.a.awrap(s["a"].getMonthlyReports(h));case 10:m=f.sent,l["a"].hide(),this.monthlyList=m.data.data,this.monthlyList.forEach((function(e,t){e.index=10*(a-1)+t+1})),this.pagination.rowsNumber=m.data.totalCount,this.pagination.page=a,this.pagination.rowsPerPage=r,this.pagination.sortBy=o,this.pagination.descending=c,f.next=25;break;case 21:f.prev=21,f.t0=f["catch"](7),l["a"].hide(),console.log("errorrrrrrrrrr",f.t0);case 25:case"end":return f.stop()}}),null,this,[[7,21]])},remove:function(e){var t=this;this.$q.dialog({title:"Confirm",message:"Are you surely remove "+e.report_title+"?",cancel:!0,persistent:!0}).onOk((function(){var a,r;return n.a.async((function(i){while(1)switch(i.prev=i.next){case 0:return a={conditions:{id:e.id}},l["a"].show(),i.prev=2,i.next=5,n.a.awrap(s["a"].removeReport(a));case 5:r=i.sent,l["a"].hide(),console.log("remove result",r),t.$q.notify({color:"positive",position:"top",message:e.report_title+" is removed successfully !"}),t.getMonthlyList({pagination:t.pagination,filter:void 0}),i.next=15;break;case 12:i.prev=12,i.t0=i["catch"](2),l["a"].hide();case 15:case"end":return i.stop()}}),null,null,[[2,12]])})).onCancel((function(){})).onDismiss((function(){}))},exportTable:function(){var e=this,t=[this.columns.map((function(e){return u(e.label)}))].concat(this.monthlyList.map((function(t){return e.columns.map((function(e){return"is_group"===e.field?u(1===t.is_group?"DAILY":"EXTRA",e.format):u(t[e.field],e.format)})).join(",")}))).join("\r\n"),a=Object(d["a"])("table-export.xls",t,"text/csv");!0!==a&&this.$q.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}},created:function(){}},h=p,m=(a("e0b0"),a("2877")),f=a("9989"),b=a("eaac"),g=a("27f9"),w=a("0016"),_=a("7cbe"),v=a("52ee"),D=a("bd08"),x=a("db86"),y=a("9c40"),q=a("24e8"),k=a("f09f"),R=a("d847"),C=a("05c0"),Y=a("eb85"),M=a("a370"),P=a("0378"),L=a("ddd8"),S=a("4b7e"),E=a("7f67"),T=a("eebe"),N=a.n(T),A=Object(m["a"])(h,r,i,!1,null,null,null);t["default"]=A.exports;N()(A,"components",{QPage:f["a"],QTable:b["a"],QInput:g["a"],QIcon:w["a"],QPopupProxy:_["a"],QDate:v["a"],QTr:D["a"],QTd:x["a"],QBtn:y["a"],QDialog:q["a"],QCard:k["a"],QBar:R["a"],QTooltip:C["a"],QSeparator:Y["a"],QCardSection:M["a"],QForm:P["a"],QSelect:L["a"],QCardActions:S["a"]}),N()(A,"directives",{ClosePopup:E["a"]})},e0b0:function(e,t,a){"use strict";var r=a("1e37"),i=a.n(r);i.a}}]);