(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{"1f5c":function(e,t,a){},d1ba:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[[a("div",[a("q-table",{class:"ios"===e.is_mobile?"my-sticky-dynamic table-top-ios":"android"===e.is_mobile?"my-sticky-dynamic table-top-android":"my-sticky-dynamic",attrs:{title:"DRIVERS",data:e.driverList,columns:"admin"===e.userLevel?e.columns_admin:e.columns,"row-key":"driver_name",pagination:e.pagination,filter:e.filter,"binary-state-sort":"","virtual-scroll":"","virtual-scroll-item-size":48,"virtual-scroll-sticky-size-start":48,"rows-per-page-options":[0]},on:{"update:pagination":function(t){e.pagination=t},request:e.getDrivers,"virtual-scroll":e.onScroll},scopedSlots:e._u([{key:"top-left",fn:function(){return[a("div",{staticClass:"items-center"},[a("q-btn",{staticStyle:{width:"168px",height:"40px"},attrs:{rounded:"",dense:"","no-caps":"",label:"+Add Driver",color:"blue-7"},on:{click:function(t){return e.createNew()}}})],1)]},proxy:!0},{key:"top-right",fn:function(){return[a("q-input",{staticClass:"q-mb-sm",staticStyle:{width:"168px"},attrs:{dense:"",debounce:"300",placeholder:"Search","input-class":"text-white border-white",color:"blue-7"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search",color:"white"}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})]},proxy:!0},{key:"body",fn:function(t){return[a("q-tr",{attrs:{props:t},nativeOn:{click:function(a){return e.goToDetail(t.row.id)}}},[a("q-td",{key:"no",attrs:{props:t}},[e._v(e._s(t.row.index))]),a("q-td",{key:"full_name",attrs:{props:t}},[e._v(e._s(t.row.full_name))]),a("q-td",{key:"driver_name",attrs:{props:t}},[e._v(e._s(t.row.driver_name))]),a("q-td",{key:"email",attrs:{props:t}},[e._v(e._s(t.row.email))]),a("q-td",{key:"phone",attrs:{props:t}},[e._v(e._s(t.row.phone))]),a("q-td",{key:"pay_type",attrs:{props:t}},[e._v(e._s("per_stop"===t.row.pay_type?"PAY PER STOP":"FIXED RATE"))]),a("q-td",{key:"pay_amount",attrs:{props:t}},[e._v(e._s("Â£"+t.row.pay_amount))]),a("q-td",{key:"vat_percentage",attrs:{props:t}},[e._v(e._s(100*t.row.vat_percentage+"%"))]),a("q-td",{key:"has_access",attrs:{props:t}},[e._v(e._s(t.row.has_access?"YES":"NO"))]),"admin"===e.userLevel?a("q-td",{key:"user_name",attrs:{props:t}},[e._v(e._s(t.row.user.full_name))]):e._e()],1)]}},{key:"bottom",fn:function(){return[a("div",{staticClass:"col-12 row justify-end items-center"},[e._v("\n            Total Records: "+e._s(e.pagination.rowsNumber)+"\n            ")])]},proxy:!0}])})],1),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:e.showDetail,callback:function(t){e.showDetail=t},expression:"showDetail"}},[a("q-card",{staticStyle:{"background-color":"#3E444E","max-width":"500px","min-height":"500px"}},[a("q-bar",{staticStyle:{"background-color":"#272B33"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close",color:"white"}},[a("q-tooltip",{attrs:{"content-class":"bg-white text-black"}},[e._v("Close")])],1),a("div",{staticClass:"text-h6 text-white"},[e._v(e._s(e.dialogTitle))])],1),a("q-separator"),a("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"50vh"}},[a("q-form",{ref:"selectedName",staticStyle:{width:"320px",margin:"auto"},attrs:{model:e.selectedName},on:{submit:e.onSubmit}},[a("div",{staticClass:"row justify-between q-col-gutter-md"},[a("div",{staticClass:"col-12"},[a("span",{staticClass:"text-white"},[e._v("Driver")]),a("q-input",{attrs:{dense:"",outlined:"",required:"",color:"blue-7","bg-color":"white","input-class":"text-black text-center"},model:{value:e.selectedName.driver_name,callback:function(t){e.$set(e.selectedName,"driver_name",t)},expression:"selectedName.driver_name"}})],1)]),a("q-separator"),a("q-card-actions",{attrs:{align:"center"}},[e.isNewRecord?e._e():a("q-btn",{staticStyle:{width:"100px",height:"40px"},attrs:{"no-caps":"",dense:"",rounded:"",label:"Delete",color:"blue-7"},on:{click:e.remove}}),a("q-btn",{staticStyle:{width:"100px",height:"40px"},attrs:{label:e.isNewRecord?"Add":"Update",color:"blue-7","no-caps":"",dense:"",rounded:"",type:"submit"}})],1)],1)],1)],1)],1)]],2)},r=[],n=a("a34a"),s=a.n(n),o=(a("96cf"),a("c973")),l=a.n(o),c=a("1e53"),d=a("f508"),u={name:"DriverList",data:function(){return{filter:"",showDetail:!1,pagination:{sortBy:"driver_name",descending:!1,page:1,rowsPerPage:100,rowsNumber:20},columns:[{name:"no",required:!0,label:"NO",align:"left",field:"no"},{name:"full_name",required:!0,label:"NAME",align:"left",field:"full_name"},{name:"driver_name",required:!0,label:"USERNAME",align:"left",field:"driver_name"},{name:"email",required:!0,label:"EMAIL",align:"left",field:"email"},{name:"phone",required:!0,label:"PHONE",align:"left",field:"phone"},{name:"pay_type",required:!0,label:"PAYMENT TYPE",align:"left",field:"pay_type"},{name:"pay_amount",required:!0,label:"PRICE",align:"left",field:"pay_amount"},{name:"vat_percentage",required:!0,label:"VAT",align:"left",field:"vat_percentage"},{name:"has_access",required:!0,label:"ACCESS",align:"left",field:"has_access"}],columns_admin:[{name:"no",required:!0,label:"NO",align:"left",field:"no"},{name:"full_name",required:!0,label:"NAME",align:"left",field:"full_name"},{name:"driver_name",required:!0,label:"USERNAME",align:"left",field:"driver_name"},{name:"email",required:!0,label:"EMAIL",align:"left",field:"email"},{name:"phone",required:!0,label:"PHONE",align:"left",field:"phone"},{name:"pay_type",required:!0,label:"PAYMENT TYPE",align:"left",field:"pay_type"},{name:"pay_amount",required:!0,label:"PRICE",align:"left",field:"pay_amount"},{name:"vat_percentage",required:!0,label:"VAT",align:"left",field:"vat_percentage"},{name:"has_access",required:!0,label:"ACCESS",align:"left",field:"has_access"},{name:"user_name",required:!0,label:"USER",align:"left",field:"user_name"}],driverList:[],selectedName:{driver_name:""},dialogTitle:"",is_mobile:"web",isNewRecord:!0}},computed:{userLevel:{get:function(){return this.$store.state.auth.userLevel}}},mounted:function(){this.checkPlatform(),this.$store.commit("auth/pageTitle",this.$router.currentRoute.meta.title),this.getDrivers({pagination:this.pagination,filter:void 0})},methods:{checkPlatform:function(){this.$q.platform.is.mobile?this.$q.platform.is.ios?this.is_mobile="ios":this.is_mobile="android":this.is_mobile="web"},createNew:function(){this.$router.push({name:"New Driver"})},goToDetail:function(e){this.$router.push({name:"Driver Details",params:{id:e}})},onScroll:function(e){var t=this;return l()(s.a.mark((function a(){var i,r,n,o,l,c,d;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(i=e.index,e.from,e.to,e.ref,r=t.pagination,n=r.page,o=r.rowsPerPage,l=r.rowsNumber,c=t.driverList.length-1,d=Math.ceil(l/o),!(i>0&&n<d&&i===c)){a.next=8;break}return t.pagination.page++,a.next=8,t.getDrivers({pagination:t.pagination,filter:t.filter,isScroll:!0});case 8:case"end":return a.stop()}}),a)})))()},getDrivers:function(){var e=l()(s.a.mark((function e(t){var a,i,r,n,o,l,u,p,m,f,h,v;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.pagination,i=a.page,r=a.rowsPerPage,n=a.rowsNumber,o=a.sortBy,l=a.descending,u=t.filter,p=t.isScroll,m=0===r?n:r,f=(i-1)*r,h={conditions:{},start:f,numPerPage:m,sortBy:o,descending:l},u&&(h.conditions.filter=u),d["a"].show(),e.prev=8,e.next=11,c["a"].getDrivers(h);case 11:v=e.sent,d["a"].hide(),v.data.data.forEach((function(e,t){e.index=10*(i-1)+t+1})),this.driverList=p?this.driverList.concat(v.data.data):v.data.data,this.pagination.rowsNumber=v.data.totalCount,this.pagination.page=i,this.pagination.rowsPerPage=r,this.pagination.sortBy=o,this.pagination.descending=l,e.next=25;break;case 22:e.prev=22,e.t0=e["catch"](8),d["a"].hide();case 25:case"end":return e.stop()}}),e,this,[[8,22]])})));function t(t){return e.apply(this,arguments)}return t}(),cancelDetail:function(){this.showDetail=!1,this.selectedName={}},onSubmit:function(){var e=this;return l()(s.a.mark((function t(){var a,i,r;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a={data:e.selectedName},!e.selectedName.id){t.next=19;break}return a.conditions={id:e.selectedName.id},d["a"].show(),t.prev=4,t.next=7,c["a"].updateDriver(a);case 7:i=t.sent,d["a"].hide(),console.log("result",i.data),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](4),d["a"].hide(),console.log("error",t.t0);case 16:e.cancelDetail(),t.next=33;break;case 19:return d["a"].show(),t.prev=20,t.next=23,c["a"].createDriver(a);case 23:r=t.sent,d["a"].hide(),console.log("result",r.data),t.next=32;break;case 28:t.prev=28,t.t1=t["catch"](20),d["a"].hide(),console.log("error",t.t1);case 32:e.cancelDetail();case 33:e.getDrivers({pagination:e.pagination,filter:void 0});case 34:case"end":return t.stop()}}),t,null,[[4,12],[20,28]])})))()},remove:function(){var e=this;this.$q.dialog({title:"Confirm",message:"Are you surely remove "+this.selectedName.driver_name+"?",cancel:!0,persistent:!0,color:"blue-7"}).onOk(l()(s.a.mark((function t(){var a,i;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={conditions:{id:e.selectedName.id}},d["a"].show(),t.prev=2,t.next=5,c["a"].removeDriver(a);case 5:i=t.sent,d["a"].hide(),console.log("remove result",i),e.$q.notify({color:"positive",position:"top",message:e.selectedName.driver_name+" is removed successfully !"}),e.cancelDetail(),e.getDrivers({pagination:e.pagination,filter:void 0}),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](2),d["a"].hide();case 16:case"end":return t.stop()}}),t,null,[[2,13]])})))).onCancel((function(){})).onDismiss((function(){}))}},created:function(){}},p=u,m=(a("d9fe"),a("2877")),f=a("9989"),h=a("eaac"),v=a("9c40"),g=a("27f9"),_=a("0016"),b=a("bd08"),w=a("db86"),y=a("24e8"),q=a("f09f"),k=a("d847"),x=a("05c0"),N=a("eb85"),D=a("a370"),S=a("0378"),E=a("4b7e"),P=a("7f67"),C=a("eebe"),A=a.n(C),T=Object(m["a"])(p,i,r,!1,null,null,null);t["default"]=T.exports;A()(T,"components",{QPage:f["a"],QTable:h["a"],QBtn:v["a"],QInput:g["a"],QIcon:_["a"],QTr:b["a"],QTd:w["a"],QDialog:y["a"],QCard:q["a"],QBar:k["a"],QTooltip:x["a"],QSeparator:N["a"],QCardSection:D["a"],QForm:S["a"],QCardActions:E["a"]}),A()(T,"directives",{ClosePopup:P["a"]})},d9fe:function(e,t,a){"use strict";var i=a("1f5c"),r=a.n(i);r.a}}]);