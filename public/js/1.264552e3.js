(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"521d":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-page",{staticClass:"q-mt-none"},[[r("div",[r("q-bar",[r("q-btn",{attrs:{dense:"",flat:"",icon:"close"},on:{click:function(e){return t.$router.push("/dashboard/reports")}}}),r("div",{staticClass:"text-h6"},[t._v(t._s(t.isNewPage?"New Report":"Report Detail"))])],1)],1),r("div",{staticClass:"q-pa-md",staticStyle:{"background-color":"#3E444E"}},[r("q-form",{ref:"reportForm",staticClass:"text-center q-gutter-y-md q-pa-md",staticStyle:{"max-width":"400px",width:"100%","border-radius":"10px",margin:"auto"},attrs:{rounded:"",model:t.reportForm},on:{submit:t.onSubmit}},[r("div",{staticClass:"row justify-between q-col-gutter-md"},[r("div",{staticClass:"col-12"},[r("q-input",{attrs:{dense:"",outlined:"","bg-color":"white","input-class":"text-black text-center",type:"date"},model:{value:t.reportForm.report_date,callback:function(e){t.$set(t.reportForm,"report_date",e)},expression:"reportForm.report_date"}})],1),t._l(t.routes,(function(e,a){return r("div",{key:e.id,staticClass:"col-12"},[r("q-select",{staticClass:"q-mb-xs",attrs:{dense:"",label:"Name",outlined:"","use-input":"","hide-selected":"","fill-input":"",options:t.filteredNames,"option-value":function(t){return null===t?null:t.id},"option-label":function(t){return null===t?"- Null -":t.courier_name},"emit-value":"","map-options":"","label-color":"grey-7",behavior:"menu","bg-color":"white","input-class":"text-black",rules:[function(e){return t.checkDuplicates(e)||"This record is duplicated"}],"hide-dropdown-icon":!0},on:{filter:t.filterFn},scopedSlots:t._u([{key:"append",fn:function(){return[""!==t.reportForm.report_data[a].courier_id?r("q-icon",{staticClass:"cursor-pointer",attrs:{name:"clear"},on:{click:function(e){t.reportForm.report_data[a].courier_id=""}}}):t._e()]},proxy:!0}],null,!0),model:{value:t.reportForm.report_data[a].courier_id,callback:function(e){t.$set(t.reportForm.report_data[a],"courier_id",e)},expression:"reportForm.report_data[index].courier_id"}}),r("q-input",{attrs:{required:"",dense:"",outlined:"",label:"Route","bg-color":"blue-grey-4","input-class":"text-black","label-color":"grey-3",color:"black",value:e.route_number,disable:""}})],1)}))],2),r("div",{staticClass:"q-pa-md"},[r("q-btn",{staticClass:"q-mt-xs",staticStyle:{width:"100px",height:"40px"},attrs:{color:"primary",label:t.isNewPage?"Add New":"Update","no-caps":"",dense:"",rounded:"",type:"submit"}})],1)])],1),r("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"scale","transition-hide":"scale"},model:{value:t.showEmptyDlg,callback:function(e){t.showEmptyDlg=e},expression:"showEmptyDlg"}},[r("q-card",[r("q-bar",[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}},[r("q-tooltip",{attrs:{"content-class":"bg-white text-primary"}},[t._v("Close")])],1)],1),r("div",{staticClass:"layout-center"},[r("q-card-section",[r("div",{staticClass:"text-h6 text-center"},[t._v("You did not provide the driver name of the routes "+t._s(t.checkEmptyDrivers().join(","))+".")]),r("div",{staticClass:"text-h6 text-center"},[t._v("Do you want to continue?")])]),r("q-card-section",{staticClass:"text-center q-pt-none"},[r("q-btn",{staticClass:"q-mt-xs q-mx-xs",staticStyle:{width:"100px",height:"40px"},attrs:{color:"primary",label:"Back","no-caps":"",dense:"",rounded:""},on:{click:function(e){t.showEmptyDlg=!1}}}),r("q-btn",{staticClass:"q-mt-xs q-mx-xs",staticStyle:{width:"100px",height:"40px"},attrs:{color:"primary",label:"Yes","no-caps":"",dense:"",rounded:""},on:{click:t.addRecords}})],1)],1)],1)],1)]],2)},o=[],s=r("967e"),i=r.n(s),n=(r("96cf"),r("1e53")),c=r("f508"),u=r("bd4c"),d={name:"ReportDetail",data:function(){return{isNewPage:!0,showEmptyDlg:!1,reportForm:{report_date:"",report_title:"",report_no:"",user_id:"",report_data:[]},routes:[],couriers:[],filteredNames:[]}},created:function(){return i.a.async((function(t){while(1)switch(t.prev=t.next){case 0:return this.isNew(),this.reportForm.user_id=this.$store.getters["auth/user"].id,this.reportForm.report_date=u["a"].formatDate(new Date,"YYYY-MM-DD"),t.next=5,i.a.awrap(this.getCourierList());case 5:if(this.isNewPage){t.next=8;break}return t.next=8,i.a.awrap(this.getReportInfo(this.reportForm.report_no));case 8:return t.next=10,i.a.awrap(this.getRouteList());case 10:case"end":return t.stop()}}),null,this)},methods:{isNew:function(){null!==this.$router.currentRoute.params.report_no&&void 0!==this.$router.currentRoute.params.report_no&&""!==this.$router.currentRoute.params.report_no?(this.isNewPage=!1,this.reportForm.report_no=this.$router.currentRoute.params.report_no):this.isNewPage=!0},getReportInfo:function(t){var e;return i.a.async((function(r){while(1)switch(r.prev=r.next){case 0:return c["a"].show(),r.prev=1,r.next=4,i.a.awrap(n["a"].getReportInfo(t));case 4:e=r.sent,c["a"].hide(),this.reportForm.report_date=e.data.data[0].report_date,this.reportForm.report_title=e.data.data[0].report_title,this.reportForm.report_no=e.data.data[0].report_no,this.reportForm.report_data=e.data.data.map((function(t){var e={id:t.id,courier_id:t.courier_id,route_id:t.route_id,route_number:t.route.route_number};return e})),r.next=16;break;case 12:r.prev=12,r.t0=r["catch"](1),c["a"].hide(),this.$router.push("/dashboard/reports");case 16:case"end":return r.stop()}}),null,this,[[1,12]])},getRouteList:function(){var t,e=this;return i.a.async((function(r){while(1)switch(r.prev=r.next){case 0:return c["a"].show(),r.prev=1,r.next=4,i.a.awrap(n["a"].getRouteList());case 4:t=r.sent,c["a"].hide(),this.routes=t.data.data,this.routes.forEach((function(t,r){var a=e.reportForm.report_data.filter((function(e){return e.route_id===t.id}));a.length||e.reportForm.report_data.push({courier_id:"",route_id:t.id,route_number:t.route_number})})),r.next=14;break;case 10:r.prev=10,r.t0=r["catch"](1),c["a"].hide(),this.$router.push("/dashboard/reports");case 14:case"end":return r.stop()}}),null,this,[[1,10]])},getCourierList:function(){var t;return i.a.async((function(e){while(1)switch(e.prev=e.next){case 0:return c["a"].show(),e.prev=1,e.next=4,i.a.awrap(n["a"].getCourierList());case 4:t=e.sent,c["a"].hide(),this.couriers=t.data.data,this.isNewPage||(this.filteredNames=this.couriers),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](1),c["a"].hide(),this.$router.push("/dashboard/reports");case 14:case"end":return e.stop()}}),null,this,[[1,10]])},filterFn:function(t,e,r){var a=this;e((function(){if(""===t)a.filteredNames=[];else{var e=t.toLowerCase();a.filteredNames=a.couriers.filter((function(t){return t.courier_name.toLowerCase().indexOf(e)>-1})),a.filteredNames=a.filteredNames.slice(0,3)}}))},checkDuplicates:function(t){var e=this.reportForm.report_data.map((function(t){return t.courier_id}));e=e.filter((function(t,e){return""!==t&&"RNC"!==t}));var r=e.filter((function(t,r){return e.indexOf(t)!==r}));return!(r.length>0)},checkEmptyDrivers:function(){var t=this.reportForm.report_data.filter((function(t,e){return""===t.courier_id})),e=t.map((function(t){return t.route_number}));return e},addRecords:function(){var t,e,r;return i.a.async((function(a){while(1)switch(a.prev=a.next){case 0:if(this.reportForm.report_data=this.reportForm.report_data.map((function(t){var e={};return t.courier_id?e=t:(t.id&&(e.id=t.id),e.courier_id="RNC",e.route_id=t.route_id),e})),t={data:this.reportForm},this.isNewPage){a.next=21;break}return t.conditions={report_no:this.reportForm.report_no},c["a"].show(),a.prev=5,a.next=8,i.a.awrap(n["a"].updateReport(t));case 8:e=a.sent,c["a"].hide(),console.log("result",e.data),this.$router.push("/dashboard/reports"),a.next=19;break;case 14:a.prev=14,a.t0=a["catch"](5),c["a"].hide(),console.log("error",a.t0),this.$router.push("/dashboard/reports");case 19:a.next=36;break;case 21:return c["a"].show(),a.prev=22,a.next=25,i.a.awrap(n["a"].createReport(t));case 25:r=a.sent,c["a"].hide(),console.log("result",r.data),this.$router.push("/dashboard/reports"),a.next=36;break;case 31:a.prev=31,a.t1=a["catch"](22),c["a"].hide(),console.log("error",a.t1),this.$router.push("/dashboard/reports");case 36:case"end":return a.stop()}}),null,this,[[5,14],[22,31]])},onSubmit:function(){this.checkEmptyDrivers().length?this.showEmptyDlg=!0:this.addRecords()}}},p=d,l=(r("e2a6"),r("2877")),h=r("9989"),m=r("d847"),f=r("9c40"),_=r("0378"),b=r("27f9"),w=r("ddd8"),v=r("0016"),x=r("24e8"),g=r("f09f"),y=r("05c0"),q=r("a370"),k=r("7f67"),F=r("eebe"),C=r.n(F),N=Object(l["a"])(p,a,o,!1,null,null,null);e["default"]=N.exports;C()(N,"components",{QPage:h["a"],QBar:m["a"],QBtn:f["a"],QForm:_["a"],QInput:b["a"],QSelect:w["a"],QIcon:v["a"],QDialog:x["a"],QCard:g["a"],QTooltip:y["a"],QCardSection:q["a"]}),C()(N,"directives",{ClosePopup:k["a"]})},e2a6:function(t,e,r){"use strict";var a=r("e75c"),o=r.n(a);o.a},e75c:function(t,e,r){}}]);