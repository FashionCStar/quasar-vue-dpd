(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{"7eaf":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{attrs:{padding:""}},[[a("div",{staticClass:"q-pa-md"},[a("q-table",{attrs:{title:"ROUTES",data:e.routeList,columns:e.columns,"row-key":"route_number",pagination:e.pagination,filter:e.filter,"binary-state-sort":""},on:{"update:pagination":function(t){e.pagination=t},request:e.getRoutes},scopedSlots:e._u([{key:"top-left",fn:function(){return[a("div",{staticClass:"items-center"},[a("q-btn",{staticClass:"bg-white text-primary shadow-3 q-btn--push",on:{click:function(t){return e.goToDetail()}}},[e._v("\n              New ROUTE\n            ")])],1)]},proxy:!0},{key:"top-right",fn:function(){return[a("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})]},proxy:!0},{key:"body",fn:function(t){return[a("q-tr",{attrs:{props:t},nativeOn:{click:function(a){return e.goToDetail(t.row)}}},[a("q-td",{key:"route_number",attrs:{props:t}},[e._v(e._s(t.row.route_number))]),a("q-td",{key:"buttons",attrs:{props:t}},[a("q-btn",{attrs:{icon:"fas fa-trash-alt"},on:{click:function(a){return e.remove(t.row)}},nativeOn:{click:function(e){e.stopPropagation()}}})],1)],1)]}}])})],1),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:e.showDetail,callback:function(t){e.showDetail=t},expression:"showDetail"}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"text-h6"},[e._v(e._s(e.dialogTitle))])]),a("q-separator"),a("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"50vh"}},[a("q-form",{ref:"selectedNumber",attrs:{model:e.selectedNumber},on:{submit:e.onSubmit}},[a("div",{staticClass:"row justify-between q-col-gutter-md"},[a("div",{staticClass:"col-12"},[a("q-input",{attrs:{outlined:"",required:"",label:"Number",color:"cyan-7"},model:{value:e.selectedNumber.route_number,callback:function(t){e.$set(e.selectedNumber,"route_number",t)},expression:"selectedNumber.route_number"}})],1)]),a("q-separator"),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",label:"Cancel",color:"primary"},on:{click:e.cancelDetail}}),a("q-btn",{attrs:{flat:"",label:"Save",color:"primary",type:"submit"}})],1)],1)],1)],1)],1)]],2)},r=[],i=a("967e"),o=a.n(i),s=(a("96cf"),a("1e53")),c=a("f508"),u={name:"RouteList",data:function(){return{filter:"",showDetail:!1,pagination:{sortBy:"route_number",descending:!1,page:1,rowsPerPage:10,rowsNumber:20},columns:[{name:"route_number",required:!0,label:"ROUTE",align:"left",field:"route_number",sortable:!0},{name:"buttons",label:"",field:"buttons"}],routeList:[],selectedNumber:{route_number:""},dialogTitle:""}},mounted:function(){this.$store.commit("auth/pageTitle",this.$router.currentRoute.meta.title),this.getRoutes({pagination:this.pagination,filter:void 0})},methods:{createNew:function(){this.$router.push({name:"NewNumber"})},goToDetail:function(e){e?(this.dialogTitle="Edit Number",this.selectedNumber.id=e.id,this.selectedNumber.route_number=e.route_number):(this.dialogTitle="Add New Number",this.selectedNumber={route_number:""}),this.showDetail=!0},getRoutes:function(e){var t,a,n,r,i,u,l,d,p,h,m;return o.a.async((function(b){while(1)switch(b.prev=b.next){case 0:return t=e.pagination,a=t.page,n=t.rowsPerPage,r=t.rowsNumber,i=t.sortBy,u=t.descending,l=e.filter,d=0===n?r:n,p=(a-1)*n,h={conditions:{},start:p,numPerPage:d,sortBy:i,descending:u},l&&(h.conditions.filter=l),c["a"].show(),b.prev=7,b.next=10,o.a.awrap(s["a"].getRoutes(h));case 10:m=b.sent,c["a"].hide(),this.routeList=m.data.data,this.routeList.forEach((function(e,t){e.index=t+1})),this.pagination.rowsNumber=m.data.totalCount,this.pagination.page=a,this.pagination.rowsPerPage=n,this.pagination.sortBy=i,this.pagination.descending=u,b.next=25;break;case 21:b.prev=21,b.t0=b["catch"](7),c["a"].hide(),console.log("errorrrrrrrrrr",b.t0);case 25:case"end":return b.stop()}}),null,this,[[7,21]])},cancelDetail:function(){this.showDetail=!1,this.selectedNumber={}},onSubmit:function(){var e,t,a;return o.a.async((function(n){while(1)switch(n.prev=n.next){case 0:if(e={data:this.selectedNumber},!this.selectedNumber.id){n.next=19;break}return e.conditions={id:this.selectedNumber.id},c["a"].show(),n.prev=4,n.next=7,o.a.awrap(s["a"].updateRoute(e));case 7:t=n.sent,c["a"].hide(),console.log("result",t.data),n.next=16;break;case 12:n.prev=12,n.t0=n["catch"](4),c["a"].hide(),console.log("error",n.t0);case 16:this.cancelDetail(),n.next=33;break;case 19:return c["a"].show(),n.prev=20,n.next=23,o.a.awrap(s["a"].createRoute(e));case 23:a=n.sent,c["a"].hide(),console.log("result",a.data),n.next=32;break;case 28:n.prev=28,n.t1=n["catch"](20),c["a"].hide(),console.log("error",n.t1);case 32:this.cancelDetail();case 33:this.getRoutes({pagination:this.pagination,filter:void 0});case 34:case"end":return n.stop()}}),null,this,[[4,12],[20,28]])},remove:function(e){var t=this;this.$q.dialog({title:"Confirm",message:"Are you surely remove "+e.route_number+"?",cancel:!0,persistent:!0}).onOk((function(){var a,n;return o.a.async((function(r){while(1)switch(r.prev=r.next){case 0:return a={conditions:{id:e.id}},c["a"].show(),r.prev=2,r.next=5,o.a.awrap(s["a"].removeRoute(a));case 5:n=r.sent,c["a"].hide(),console.log("remove result",n),t.$q.notify({color:"positive",position:"top",message:e.route_number+" is removed successfully !"}),t.getRoutes({pagination:t.pagination,filter:void 0}),r.next=15;break;case 12:r.prev=12,r.t0=r["catch"](2),c["a"].hide();case 15:case"end":return r.stop()}}),null,null,[[2,12]])})).onCancel((function(){})).onDismiss((function(){}))}},created:function(){}},l=u,d=a("2877"),p=a("9989"),h=a("eaac"),m=a("9c40"),b=a("27f9"),f=a("0016"),g=a("bd08"),w=a("db86"),v=a("24e8"),y=a("f09f"),q=a("a370"),k=a("eb85"),x=a("0378"),N=a("4b7e"),_=a("eebe"),D=a.n(_),C=Object(d["a"])(l,n,r,!1,null,null,null);t["default"]=C.exports;D()(C,"components",{QPage:p["a"],QTable:h["a"],QBtn:m["a"],QInput:b["a"],QIcon:f["a"],QTr:g["a"],QTd:w["a"],QDialog:v["a"],QCard:y["a"],QCardSection:q["a"],QSeparator:k["a"],QForm:x["a"],QCardActions:N["a"]})}}]);