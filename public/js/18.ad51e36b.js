(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{"7eaf":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{attrs:{padding:""}},[[a("div",{staticClass:"q-pa-md"},[a("q-table",{attrs:{title:"ROUTES",data:e.routeList,columns:e.columns,"row-key":"route_number",pagination:e.pagination,filter:e.filter,"binary-state-sort":""},on:{"update:pagination":function(t){e.pagination=t},request:e.getRoutes},scopedSlots:e._u([{key:"top-left",fn:function(){return[a("div",{staticClass:"items-center"},[a("q-btn",{staticClass:"bg-white text-primary shadow-3 q-btn--push",on:{click:function(t){return e.goToDetail()}}},[e._v("\n              New ROUTE\n            ")])],1)]},proxy:!0},{key:"top-right",fn:function(){return[a("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})]},proxy:!0},{key:"body",fn:function(t){return[a("q-tr",{attrs:{props:t},nativeOn:{click:function(a){return e.goToDetail(t.row)}}},[a("q-td",{key:"route_number",attrs:{props:t}},[e._v(e._s(t.row.route_number))]),a("q-td",{key:"route_type",attrs:{props:t}},[e._v(e._s(t.row.route_type?"Extra Route":"Regular Route"))]),a("q-td",{key:"buttons",attrs:{props:t}},[a("q-btn",{attrs:{icon:"fas fa-trash-alt"},on:{click:function(a){return e.remove(t.row)}},nativeOn:{click:function(e){e.stopPropagation()}}})],1)],1)]}}])})],1),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:e.showDetail,callback:function(t){e.showDetail=t},expression:"showDetail"}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"text-h6"},[e._v(e._s(e.dialogTitle))])]),a("q-separator"),a("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"50vh"}},[a("q-form",{ref:"selectedNumber",attrs:{model:e.selectedNumber},on:{submit:e.onSubmit}},[a("div",{staticClass:"row justify-between q-col-gutter-md"},[a("div",{staticClass:"col-12"},[a("q-input",{attrs:{outlined:"",required:"",label:"Number",color:"cyan-7"},model:{value:e.selectedNumber.route_number,callback:function(t){e.$set(e.selectedNumber,"route_number",t)},expression:"selectedNumber.route_number"}})],1),a("div",{staticClass:"col-12"},[a("q-select",{staticClass:"q-mb-xs",attrs:{dense:"",label:"Route",outlined:"",options:e.route_types,"option-value":function(e){return null===e?null:e.value},"option-label":function(e){return null===e?"- Null -":e.label},"emit-value":"","map-options":"",color:"cyan-7",behavior:"menu"},model:{value:e.selectedNumber.route_type,callback:function(t){e.$set(e.selectedNumber,"route_type",t)},expression:"selectedNumber.route_type"}})],1)]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",label:"Cancel",color:"primary"},on:{click:e.cancelDetail}}),a("q-btn",{attrs:{flat:"",label:"Save",color:"primary",type:"submit"}})],1)],1)],1)],1)],1)]],2)},n=[],o=a("967e"),i=a.n(o),s=(a("96cf"),a("1e53")),l=a("f508"),u={name:"RouteList",data:function(){return{filter:"",showDetail:!1,pagination:{sortBy:"route_number",descending:!1,page:1,rowsPerPage:10,rowsNumber:20},route_types:[{label:"Regular Route",value:0},{label:"Extra Route",value:1}],columns:[{name:"route_number",required:!0,label:"ROUTE",align:"left",field:"route_number",sortable:!0},{name:"route_type",required:!0,label:"Type",align:"center",field:"route_type",sortable:!0},{name:"buttons",label:"",field:"buttons"}],routeList:[],selectedNumber:{route_number:"",route_type:""},dialogTitle:""}},mounted:function(){this.$store.commit("auth/pageTitle",this.$router.currentRoute.meta.title),this.getRoutes({pagination:this.pagination,filter:void 0})},methods:{goToDetail:function(e){e?(this.dialogTitle="Edit Route",this.selectedNumber.id=e.id,this.selectedNumber.route_number=e.route_number,this.selectedNumber.route_type=e.route_type):(this.dialogTitle="Add Route",this.selectedNumber={route_number:"",route_type:""}),this.showDetail=!0},getRoutes:function(e){var t,a,r,n,o,u,c,d,p,b,m;return i.a.async((function(h){while(1)switch(h.prev=h.next){case 0:return t=e.pagination,a=t.page,r=t.rowsPerPage,n=t.rowsNumber,o=t.sortBy,u=t.descending,c=e.filter,d=0===r?n:r,p=(a-1)*r,b={conditions:{},start:p,numPerPage:d,sortBy:o,descending:u},c&&(b.conditions.filter=c),l["a"].show(),h.prev=7,h.next=10,i.a.awrap(s["a"].getRoutes(b));case 10:m=h.sent,l["a"].hide(),this.routeList=m.data.data,this.routeList.forEach((function(e,t){e.index=t+1})),this.pagination.rowsNumber=m.data.totalCount,this.pagination.page=a,this.pagination.rowsPerPage=r,this.pagination.sortBy=o,this.pagination.descending=u,h.next=25;break;case 21:h.prev=21,h.t0=h["catch"](7),l["a"].hide(),console.log("errorrrrrrrrrr",h.t0);case 25:case"end":return h.stop()}}),null,this,[[7,21]])},cancelDetail:function(){this.showDetail=!1,this.selectedNumber={}},onSubmit:function(){var e,t,a;return i.a.async((function(r){while(1)switch(r.prev=r.next){case 0:if(e={data:this.selectedNumber},!this.selectedNumber.id){r.next=19;break}return e.conditions={id:this.selectedNumber.id},l["a"].show(),r.prev=4,r.next=7,i.a.awrap(s["a"].updateRoute(e));case 7:t=r.sent,l["a"].hide(),console.log("result",t.data),r.next=16;break;case 12:r.prev=12,r.t0=r["catch"](4),l["a"].hide(),console.log("error",r.t0);case 16:this.cancelDetail(),r.next=33;break;case 19:return l["a"].show(),r.prev=20,r.next=23,i.a.awrap(s["a"].createRoute(e));case 23:a=r.sent,l["a"].hide(),console.log("result",a.data),r.next=32;break;case 28:r.prev=28,r.t1=r["catch"](20),l["a"].hide(),console.log("error",r.t1);case 32:this.cancelDetail();case 33:this.getRoutes({pagination:this.pagination,filter:void 0});case 34:case"end":return r.stop()}}),null,this,[[4,12],[20,28]])},remove:function(e){var t=this;this.$q.dialog({title:"Confirm",message:"Are you surely remove "+e.route_number+"?",cancel:!0,persistent:!0}).onOk((function(){var a,r;return i.a.async((function(n){while(1)switch(n.prev=n.next){case 0:return a={conditions:{id:e.id}},l["a"].show(),n.prev=2,n.next=5,i.a.awrap(s["a"].removeRoute(a));case 5:r=n.sent,l["a"].hide(),console.log("remove result",r),t.$q.notify({color:"positive",position:"top",message:e.route_number+" is removed successfully !"}),t.getRoutes({pagination:t.pagination,filter:void 0}),n.next=15;break;case 12:n.prev=12,n.t0=n["catch"](2),l["a"].hide();case 15:case"end":return n.stop()}}),null,null,[[2,12]])})).onCancel((function(){})).onDismiss((function(){}))}},created:function(){}},c=u,d=a("2877"),p=a("9989"),b=a("eaac"),m=a("9c40"),h=a("27f9"),f=a("0016"),g=a("bd08"),v=a("db86"),y=a("24e8"),w=a("f09f"),_=a("a370"),q=a("eb85"),x=a("0378"),k=a("ddd8"),N=a("4b7e"),R=a("eebe"),C=a.n(R),D=Object(d["a"])(c,r,n,!1,null,null,null);t["default"]=D.exports;C()(D,"components",{QPage:p["a"],QTable:b["a"],QBtn:m["a"],QInput:h["a"],QIcon:f["a"],QTr:g["a"],QTd:v["a"],QDialog:y["a"],QCard:w["a"],QCardSection:_["a"],QSeparator:q["a"],QForm:x["a"],QSelect:k["a"],QCardActions:N["a"]})}}]);